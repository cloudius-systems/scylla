#!/usr/bin/env python3
# -*- coding: utf-8 -*-
#
# Copyright 2019-present ScyllaDB
#

#
# SPDX-License-Identifier: AGPL-3.0-or-later

import os
import sys
import argparse
from scylla_util import *

if __name__ == '__main__':
    if os.getuid() > 0:
        print('Requires root permission.')
        sys.exit(1)
    parser = argparse.ArgumentParser(description='Configure memory for Scylla.')
    parser.add_argument('--lock-memory',
                        help='lock all memory', action='store_true')
    parser.add_argument('--memory',
                        help='memory to use, in bytes (ex: 4G, default=all)')
    parser.add_argument('--reserve-memory',
                        help='memory reserved to OS (if --memory not specified)')
    args = parser.parse_args()
    if not args.lock_memory and not args.memory and not args.reserve_memory:
        parser.print_help()
        sys.exit(1)

    conf = seastar_conf()
    conf.update_with_args(args)
    conf.commit()
