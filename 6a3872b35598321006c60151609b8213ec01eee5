backport: 0.18, 0.19, 1.0
